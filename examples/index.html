<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kiwi Example</title>
  <script>
    const wsUrl = 'ws://localhost:8000/websocket';
    let webSocket;

    function setupWebSocket() {
      webSocket = new WebSocket(wsUrl);

      webSocket.onopen = function (event) {
        console.log('Connection opened:', event);
        webSocket.send(JSON.stringify({ type: 'SUBSCRIBE', sources: ['topic1'] }))
      };

      webSocket.onmessage = function (event) {
        console.log('Message received:', event.data);
        appendMessage(event.data);
      };

      webSocket.onerror = function (event) {
        console.error('WebSocket error:', event);
      };

      webSocket.onclose = function (event) {
        console.log('WebSocket connection closed:', event);
      };
    }

    function appendMessage(message) {
      const messagesDiv = document.getElementById('messages');
      const messageParagraph = document.createElement('p');
      messageParagraph.textContent = message;
      messagesDiv.appendChild(messageParagraph);
    }

    window.onload = setupWebSocket;
  </script>
</head>

<body>
  <h1>WebSocket Messages</h1>
  <div id="messages" style="border:1px solid #ccc; padding:10px; height:200px; overflow:auto;">
    <!-- Messages will be appended here -->
  </div>
</body>

</html>
